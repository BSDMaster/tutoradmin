<!DOCTYPE html>
<html>

<head>

</head>

<body>
    <div class="label-header">กลุ่มวิชาเรียนย่อย</div>
    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary container-btn-add-right" data-toggle="modal" data-target="#modalAddSubGroupCourse">
        เพิ่ม
    </button>
    <table id="gridSubGroupCourse" class="table table-condensed table-hover table-striped">
        <thead>
            <tr>
                <th data-column-id="id" data-identifier="true" data-type="numeric">ลำดับ</th>
                <th data-column-id="groupCourseName">ชื่อกลุ่มวิชา</th>
                <th data-column-id="subGroupCourseName">ชื่อกลุ่มวิชาเรียนย่อย</th>
                <th data-column-id="commands" data-formatter="commands" data-sortable="false"></th>
            </tr>
        </thead>
    </table>

    <!-- Modal Add Class-->
    <div class="modal fade" id="modalAddSubGroupCourse" tabindex="-1" role="dialog" aria-labelledby="modalAddSubGroupCourseLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalAddSubGroupCourseLabel">เพิ่มกลุ่มวิชาเรียนย่อย</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="dropdownGroupName">ชื่อกลุ่มวิชา</label>
                            <select class="form-control" id="dropdownGroupName">
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="txtSubGroupCourseName">ชื่อกลุ่มวิชาเรียนย่อย</label>
                            <input class="form-control" id="txtSubGroupCourseName">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="btnSaveAddGroupCourse">ตกลง</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        //grid Class
        if (_gGridGroupCourse != null) {
            var groupCourseData = _gGridGroupCourse.bootgrid().data('.rs.jquery.bootgrid').rows;
            for (var i = 0; i < groupCourseData.length; i++) {
                $('#dropdownGroupName').append('<option value="' + groupCourseData[i].groupCourseName + '">' + groupCourseData[i].groupCourseName + '</option>');
            }
        }

        var gridSubGroupCourse = $("#gridSubGroupCourse").bootgrid({
            formatters: {
                "taxi": function (column, row) {
                    return "<button type=\"button\" class=\"btn btn-xs btn-default command-edit\" data-row-id=\"" + row.id + "\">Car<span class=\"fa fa-pencil\"></span></button> "
                },
                "commands": function (column, row) {
                    console.log("row=", row);
                    return "<button type=\"button\" class=\"btn btn-xs btn-default command-edit\" data-row-id=\"" + row.id + "\">Edit<span class=\"fa fa-pencil\"></span></button> " +
                        "<button type=\"button\" class=\"btn btn-xs btn-default command-delete\" data-row-id=\"" + row.id + "\">Delete<span class=\"fa fa-trash-o\"></span></button>";
                }
            }
        }).on("loaded.rs.jquery.bootgrid", function () {
            gridSubGroupCourse.find(".command-edit").on("click", function (e) {
                alert("You pressed edit on row: " + $(this).data("row-id"));
            }).end().find(".command-delete").on("click", function (e) {
                var rows = [];
                rows[0] = parseInt($(this).data("row-id"));
                gridSubGroupCourse.bootgrid('remove', rows);
            });
        });

        $("#btnSaveAddGroupCourse").on("click", function (e) {
            var txtGroupCourseName = $("#dropdownGroupName option:selected").text();
            var txtSubGroupCourseName = $("#txtSubGroupCourseName").val();
            console.log("txtGroupCourseName=", txtGroupCourseName);
            console.log("txtSubGroupCourseName=", txtSubGroupCourseName);
            if (txtGroupCourseName && txtSubGroupCourseName) {
                gridSubGroupCourse.bootgrid("append", [
                    {
                        "id": gridSubGroupCourse.bootgrid("getTotalRowCount") + 1,
                        "groupCourseName": txtGroupCourseName,
                        "subGroupCourseName": txtSubGroupCourseName,
                    }
                ]);
            }
            else {
                alert("invalid input");
            }
        });
    </script>
</body>

</html>